I2luY2x1ZGUgPHdpbmRvd3MuaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciogYXJndltdKSB7DQogICAgaWYgKGFyZ2MgIT0gMikgew0KICAgICAgICBwcmludGYoIlVzYWdlOiAlcyA8c2hlbGxjb2RlLmJpbj5cbiIsIGFyZ3ZbMF0pOw0KICAgICAgICByZXR1cm4gMTsNCiAgICB9DQoNCiAgICBjb25zdCBjaGFyKiBmaWxlbmFtZSA9IGFyZ3ZbMV07DQoNCiAgICAvLyAxLiA/P2MgZmlsZSAuYmluDQogICAgRklMRSogZiA9IGZvcGVuKGZpbGVuYW1lLCAicmIiKTsgIC8vIFM/QTogZmlsZW5hbWUsIGto9G5nIHBoP2kgZmlsZW5hbWUgaW5hbWUNCiAgICBpZiAoIWYpIHsNCiAgICAgICAgcGVycm9yKCJmIEZBVEFsIG9wZW4iKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgZnNlZWsoZiwgMCwgU0VFS19FTkQpOw0KICAgIHNpemVfdCBzaXplID0gZnRlbGwoZik7DQogICAgZnNlZWsoZiwgMCwgU0VFS19TRVQpOw0KDQogICAgaWYgKHNpemUgPT0gMCkgew0KICAgICAgICBwcmludGYoIlshXSBGaWxlIGlzIGVtcHR5IVxuIik7DQogICAgICAgIGZjbG9zZShmKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgdW5zaWduZWQgY2hhciogc2hlbGxjb2RlID0gKHVuc2lnbmVkIGNoYXIqKW1hbGxvYyhzaXplKTsNCiAgICBpZiAoIXNoZWxsY29kZSkgew0KICAgICAgICBwZXJyb3IoIm1hbGxvYyIpOw0KICAgICAgICBmY2xvc2UoZik7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgIGlmIChmcmVhZChzaGVsbGNvZGUsIDEsIHNpemUsIGYpICE9IHNpemUpIHsNCiAgICAgICAgcGVycm9yKCJmcmVhZCIpOw0KICAgICAgICBmcmVlKHNoZWxsY29kZSk7DQogICAgICAgIGZjbG9zZShmKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KICAgIGZjbG9zZShmKTsNCg0KICAgIHByaW50ZigiWytdIExvYWRlZCAlenUgYnl0ZXMgZnJvbSAnJXMnXG4iLCBzaXplLCBmaWxlbmFtZSk7DQoNCiAgICAvLyAyLiBDP3AgdvluZyBuaD8gKFJXKQ0KICAgIExQVk9JRCBleGVjX21lbSA9IFZpcnR1YWxBbGxvYyhOVUxMLCBzaXplLCBNRU1fQ09NTUlUIHwgTUVNX1JFU0VSVkUsIFBBR0VfUkVBRFdSSVRFKTsNCiAgICBpZiAoIWV4ZWNfbWVtKSB7DQogICAgICAgIHBlcnJvcigiVmlydHVhbEFsbG9jIik7DQogICAgICAgIGZyZWUoc2hlbGxjb2RlKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgLy8gMy4gR2hpIHNoZWxsY29kZSB24G8gdvluZyBuaD8NCiAgICBtZW1jcHkoZXhlY19tZW0sIHNoZWxsY29kZSwgc2l6ZSk7DQogICAgZnJlZShzaGVsbGNvZGUpOw0KDQogICAgLy8gNC4gPz9pIHF1eT9uIHRo4G5oIHRoP2MgdGhpIChSWCkNCiAgICBEV09SRCBvbGRfcHJvdGVjdDsNCiAgICBpZiAoIVZpcnR1YWxQcm90ZWN0KGV4ZWNfbWVtLCBzaXplLCBQQUdFX0VYRUNVVEVfUkVBRCwgJm9sZF9wcm90ZWN0KSkgew0KICAgICAgICBwZXJyb3IoIlZpcnR1YWxQcm90ZWN0Iik7DQogICAgICAgIFZpcnR1YWxGcmVlKGV4ZWNfbWVtLCAwLCBNRU1fUkVMRUFTRSk7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgIHByaW50ZigiWytdIE1lbW9yeSBleGVjdXRhYmxlIGF0OiAlcFxuIiwgZXhlY19tZW0pOw0KDQogICAgLy8gNS4gVD9vIHRocmVhZCBjaD95IHNoZWxsY29kZQ0KICAgIEhBTkRMRSBoVGhyZWFkID0gQ3JlYXRlVGhyZWFkKA0KICAgICAgICBOVUxMLA0KICAgICAgICAwLA0KICAgICAgICAoTFBUSFJFQURfU1RBUlRfUk9VVElORSlleGVjX21lbSwNCiAgICAgICAgTlVMTCwNCiAgICAgICAgMCwNCiAgICAgICAgTlVMTA0KICAgICk7DQoNCiAgICBpZiAoIWhUaHJlYWQpIHsNCiAgICAgICAgcGVycm9yKCJDcmVhdGVUaHJlYWQiKTsNCiAgICAgICAgVmlydHVhbEZyZWUoZXhlY19tZW0sIDAsIE1FTV9SRUxFQVNFKTsNCiAgICAgICAgcmV0dXJuIDE7DQogICAgfQ0KDQogICAgcHJpbnRmKCJbK10gU2hlbGxjb2RlIHJ1bm5pbmcgaW4gbmV3IHRocmVhZC4uLlxuIik7DQoNCiAgICAvLyA2LiA/P2kgdGhyZWFkIGs/dCB0aPpjDQogICAgV2FpdEZvclNpbmdsZU9iamVjdChoVGhyZWFkLCBJTkZJTklURSk7DQogICAgQ2xvc2VIYW5kbGUoaFRocmVhZCk7DQogICAgVmlydHVhbEZyZWUoZXhlY19tZW0sIDAsIE1FTV9SRUxFQVNFKTsNCg0KICAgIHByaW50ZigiWypdIEV4ZWN1dGlvbiBjb21wbGV0ZWQuXG4iKTsNCiAgICByZXR1cm4gMDsNCn0=